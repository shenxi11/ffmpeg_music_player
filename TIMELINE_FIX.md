# è¿›åº¦æ¡è·³è½¬æ—¶åºé—®é¢˜ä¿®å¤

## ğŸ› é—®é¢˜åˆ†æ

### ä»æ—¥å¿—å‘ç°çš„é—®é¢˜
```
ç»“æŸæ‹–åŠ¨è¿›åº¦æ¡ï¼Œç«‹å³è·³è½¬åˆ°ä½ç½®: 203 ç§’  â† ç”¨æˆ·æœŸæœ›è·³è½¬ä½ç½®
TakePcm::seekToPosition è·³è½¬åˆ°ä½ç½®: 203 ç§’   â† FFmpegæ­£ç¡®è·³è½¬
ProcessSlider::slot_change_duartion time : 102 â† è¿›åº¦æ¡è¿˜æ˜¾ç¤ºæ—§ä½ç½®
...å‡ ç§’å...
TakePcm::send_data 203                      â† æœ€ç»ˆæ­£ç¡®è§£ç 
```

### æ ¹æœ¬åŸå› 
1. **é‡å¤è°ƒç”¨reset_play**: `signal_process_Change`åŒæ—¶è¿æ¥åˆ°TakePcmå’ŒWorkerï¼Œå¯¼è‡´é‡å¤æ¸…é™¤ç¼“å†²åŒº
2. **æ—¶é—´ä¿¡å·æ—¶åºæ··ä¹±**: æ‹–åŠ¨æœŸé—´æ—§çš„æ—¶é—´æ›´æ–°ä¿¡å·è¿˜åœ¨å¤„ç†
3. **è¿›åº¦æ¡æ›´æ–°è¿‡æ—©**: è·³è½¬å®Œæˆå‰å°±é‡æ–°è¿æ¥äº†æ—¶é—´æ›´æ–°

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. é¿å…é‡å¤è°ƒç”¨reset_play
**é—®é¢˜**: 
```cpp
// é”™è¯¯ï¼šé‡å¤è¿æ¥å¯¼è‡´reset_playè¢«è°ƒç”¨ä¸¤æ¬¡
connect(this, &PlayWidget::signal_process_Change, take_pcm.get(), &TakePcm::seekToPosition);
connect(this, &PlayWidget::signal_process_Change, work.get(), &Worker::reset_play);  â† ç§»é™¤è¿™è¡Œ

// TakePcmå†…éƒ¨å·²ç»ä¼šå‘é€Position_Changeä¿¡å·
emit Position_Change(); // è¿™ä¸ªä¿¡å·å·²ç»è¿æ¥åˆ°Worker::reset_play
```

**ä¿®å¤**:
```cpp
// æ­£ç¡®ï¼šåªä¿ç•™ä¸€æ¡è°ƒç”¨è·¯å¾„
signal_process_Change â†’ TakePcm::seekToPosition â†’ Position_Change â†’ Worker::reset_play
```

### 2. æ‹–åŠ¨æœŸé—´åœæ­¢æ—¶é—´æ›´æ–°
**é—®é¢˜**: æ‹–åŠ¨æœŸé—´Workerè¿˜åœ¨å‘é€æ—§çš„æ—¶é—´ä¿¡å·
```cpp
// Worker::onTimeOutä¸­æ— æ¡ä»¶å‘é€
emit durations(currentTimeMS);  // æ‹–åŠ¨æ—¶ä¹Ÿå‘é€ï¼Œå¯¼è‡´è¿›åº¦æ¡æ˜¾ç¤ºé”™ä¹±
```

**ä¿®å¤**:
```cpp
// åªåœ¨éæ‹–åŠ¨çŠ¶æ€å‘é€æ—¶é—´æ›´æ–°
if (!sliderMove) {
    emit durations(currentTimeMS);
}
```

### 3. å»¶è¿Ÿé‡è¿è¿›åº¦æ›´æ–°
**é—®é¢˜**: è·³è½¬å®Œæˆå‰å°±é‡æ–°è¿æ¥æ—¶é—´æ›´æ–°
```cpp
// é”™è¯¯ï¼šç«‹å³é‡è¿ï¼Œå¯èƒ½æ”¶åˆ°æ—§æ•°æ®
connect(work.get(), &Worker::durations, process_slider, &ProcessSlider::slot_change_duartion);
```

**ä¿®å¤**:
```cpp
// å»¶è¿Ÿ100msåé‡è¿ï¼Œç¡®ä¿è·³è½¬å®Œæˆ
QTimer::singleShot(100, [=](){
    connect(work.get(), &Worker::durations, process_slider, &ProcessSlider::slot_change_duartion);
});
```

### 4. ä¼˜åŒ–æ‰§è¡Œé¡ºåº
**ä¿®å¤å‰**:
```
1. åœæ­¢æ‹–åŠ¨çŠ¶æ€
2. æ‰§è¡Œè·³è½¬
3. ç«‹å³é‡è¿æ—¶é—´æ›´æ–°  â† é—®é¢˜ï¼šå¯èƒ½æ”¶åˆ°æ—§ä¿¡å·
```

**ä¿®å¤å**:
```
1. ç«‹å³æ‰§è¡Œè·³è½¬      â† å…ˆæ¸…é™¤æ—§æ•°æ®æµ
2. åœæ­¢æ‹–åŠ¨çŠ¶æ€
3. å»¶è¿Ÿé‡è¿æ—¶é—´æ›´æ–°  â† ç¡®ä¿è·³è½¬å®Œæˆåæ‰æ¥æ”¶æ–°ä¿¡å·
```

## ğŸ“Š ä¿¡å·æµç¨‹å›¾

### ä¿®å¤å‰çš„æ··ä¹±æµç¨‹
```
ç”¨æˆ·æ‹–åŠ¨è¿›åº¦æ¡
    â†“
signal_process_Change
    â”œâ”€â†’ TakePcm::seekToPosition â†’ Position_Change â†’ Worker::reset_play  â† ç¬¬ä¸€æ¬¡
    â””â”€â†’ Worker::reset_play  â† ç¬¬äºŒæ¬¡ï¼ˆé‡å¤ï¼ï¼‰
    
æ‹–åŠ¨æœŸé—´ï¼šWorkerç»§ç»­å‘é€durationsä¿¡å· â†’ è¿›åº¦æ¡æ˜¾ç¤ºæ··ä¹±
```

### ä¿®å¤åçš„æ¸…æ™°æµç¨‹
```
ç”¨æˆ·æ‹–åŠ¨è¿›åº¦æ¡
    â†“
signal_process_Change
    â””â”€â†’ TakePcm::seekToPosition â†’ Position_Change â†’ Worker::reset_play  â† åªä¸€æ¬¡
    
æ‹–åŠ¨æœŸé—´ï¼šWorkeråœæ­¢å‘é€durationsä¿¡å· â†’ è¿›åº¦æ¡ä¿æŒæ‹–åŠ¨ä½ç½®
è·³è½¬å®Œæˆï¼šå»¶è¿Ÿé‡è¿æ—¶é—´æ›´æ–° â†’ æ˜¾ç¤ºæ­£ç¡®çš„æ–°ä½ç½®
```

## ğŸ¯ é¢„æœŸä¿®å¤æ•ˆæœ

### ä¿®å¤åçš„æ—¥å¿—åº”è¯¥æ˜¯
```
å¼€å§‹æ‹–åŠ¨è¿›åº¦æ¡
ç»“æŸæ‹–åŠ¨è¿›åº¦æ¡ï¼Œç«‹å³è·³è½¬åˆ°ä½ç½®: 203 ç§’
TakePcm::seekToPosition è·³è½¬åˆ°ä½ç½®: 203 ç§’, back_flag: true
FFmpegè·³è½¬æˆåŠŸåˆ° 203 ç§’
Worker::set_SliderMove è®¾ç½®è¿›åº¦æ¡æ‹–åŠ¨çŠ¶æ€: false
Worker::reset_play é‡ç½®æ’­æ”¾ - æ¸…é™¤PCMç¼“å†²åŒº  â† åªè°ƒç”¨ä¸€æ¬¡
PCMç¼“å†²åŒºå·²æ¸…é™¤ï¼Œç¼“å†²åŒºå¤§å°: 0
TakePcm::send_data 203
è¿›åº¦æ¡æ—¶é—´æ›´æ–°å·²é‡æ–°è¿æ¥
ProcessSlider::slot_change_duartion time : 203  â† æ˜¾ç¤ºæ­£ç¡®ä½ç½®
```

### å…³é”®æ”¹è¿›
- âœ… **reset_playåªè°ƒç”¨ä¸€æ¬¡**: é¿å…é‡å¤æ¸…é™¤ç¼“å†²åŒº
- âœ… **æ‹–åŠ¨æœŸé—´æ— æ—¶é—´å¹²æ‰°**: Workeråœæ­¢å‘é€æ—§çš„æ—¶é—´ä¿¡å·  
- âœ… **å»¶è¿Ÿé‡è¿æœºåˆ¶**: è·³è½¬å®Œæˆåæ‰é‡æ–°æ¥æ”¶æ—¶é—´æ›´æ–°
- âœ… **è¿›åº¦æ¡æ˜¾ç¤ºæ­£ç¡®**: ç«‹å³æ˜¾ç¤ºè·³è½¬åçš„æ­£ç¡®ä½ç½®

## ğŸ”§ æ ¸å¿ƒä¿®å¤æ–‡ä»¶

1. **play_widget.cpp**
   - ç§»é™¤é‡å¤çš„reset_playè¿æ¥
   - è°ƒæ•´æ‹–åŠ¨ç»“æŸçš„æ‰§è¡Œé¡ºåº
   - æ·»åŠ å»¶è¿Ÿé‡è¿æœºåˆ¶

2. **worker.cpp**  
   - æ‹–åŠ¨æœŸé—´åœæ­¢å‘é€durationsä¿¡å·
   - é¿å…è¿›åº¦æ¡æ˜¾ç¤ºæ··ä¹±

---
*ä¿®å¤æ—¶é—´: 2025å¹´10æœˆ19æ—¥*
*é—®é¢˜ç±»å‹: ä¿¡å·æ—¶åºæ··ä¹±*
*ä¿®å¤é‡ç‚¹: å»é‡ + æ—¶åºæ§åˆ¶*